<svg id="mermaidChart1" width="100%" xmlns="http://www.w3.org/2000/svg" height="100%" style="max-width:850px;" viewBox="-50 -10 850 994"><style type="text/css" title="mermaid-svg-internal-css">/*  */
*, ::before, ::after { box-sizing: inherit;}
.actor { stroke: rgb(204, 204, 255); fill: rgb(226, 236, 255);}
text.actor { fill: black; stroke: none; font-size: 12px;}
.actor-line { stroke: grey;}
.messageLine0 { stroke-width: 1.5; stroke: black;}
.messageLine1 { stroke-width: 1.5; stroke: black;}
#arrowhead { fill: black;}
.messageText { fill: black; stroke: none; font-size: 12px;}
.labelBox { stroke: rgb(204, 204, 255); fill: rgb(236, 236, 255);}
.labelText { fill: black; stroke: none;}
.loopText { fill: black; stroke: none;}
.loopLine { stroke-width: 2; stroke: rgb(204, 204, 255);}
.note { stroke: rgb(204, 204, 255); fill: rgb(255, 245, 173);}
.noteText { fill: black; stroke: none; font-size: 12px;}
.actor { stroke: rgb(204, 204, 255); fill: rgb(236, 236, 255);}
text.actor { fill: black; stroke: none;}
.actor-line { stroke: grey;}
.messageLine0 { stroke-width: 1.5; stroke: rgb(51, 51, 51);}
.messageLine1 { stroke-width: 1.5; stroke: rgb(51, 51, 51);}
#arrowhead { fill: rgb(51, 51, 51);}
#crosshead path { fill: rgb(51, 51, 51) !important; stroke: rgb(51, 51, 51) !important;}
.messageText { fill: rgb(51, 51, 51); stroke: none;}
.labelBox { stroke: rgb(204, 204, 255); fill: rgb(236, 236, 255);}
.labelText { fill: black; stroke: none;}
.loopText { fill: black; stroke: none;}
.loopLine { stroke-width: 2; stroke: rgb(204, 204, 255);}
.note { stroke: rgb(170, 170, 51); fill: rgb(255, 245, 173);}
.noteText { fill: black; stroke: none; font-family: "trebuchet ms", verdana, arial; font-size: 14px;}
text { font-family: "trebuchet ms", verdana, arial; font-size: 14px;}
/*  */
</style><g></g><g><line id="actor3" x1="75" y1="5" x2="75" y2="983" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="0" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="75" y="37.5" class="actor" style="text-anchor: middle;">user</text></g><g><line id="actor4" x1="275" y1="5" x2="275" y2="983" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="200" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="275" y="37.5" class="actor" style="text-anchor: middle;">web</text></g><g><line id="actor5" x1="475" y1="5" x2="475" y2="983" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="400" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="475" y="37.5" class="actor" style="text-anchor: middle;">weshin</text></g><g><line id="actor6" x1="675" y1="5" x2="675" y2="983" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="600" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="675" y="37.5" class="actor" style="text-anchor: middle;">wechat</text></g><defs><marker id="arrowhead" refX="5" refY="2" markerWidth="6" markerHeight="4" orient="auto"><path d="M 0,0 V 4 L6,2 Z"></path></marker></defs><defs><marker id="crosshead" markerWidth="15" markerHeight="8" orient="auto" refX="16" refY="4"><path fill="black" stroke="#000000" stroke-width="1px" d="M 9,2 V 6 L16,4 Z" style="stroke-dasharray: 0, 0;"></path><path fill="none" stroke="#000000" stroke-width="1px" d="M 0,1 L 6,7 M 6,1 L 0,7" style="stroke-dasharray: 0, 0;"></path></marker></defs><g><text x="175" y="93" class="messageText" style="text-anchor: middle;">用户访问公众号页面</text><line x1="75" y1="100" x2="275" y2="100" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><text x="275" y="128" class="messageText" style="text-anchor: middle;">查询用户信息</text><path d="M 275,135 C 335,125 335,165 275,155" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></path></g><g><text x="175" y="218" class="messageText" style="text-anchor: middle;">web服务</text><line x1="275" y1="225" x2="75" y2="225" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><line x1="65" y1="175" x2="285" y2="175" stroke-width="2" stroke="#526e52" class="loopLine"></line><line x1="285" y1="175" x2="285" y2="235" stroke-width="2" stroke="#526e52" class="loopLine"></line><line x1="65" y1="235" x2="285" y2="235" stroke-width="2" stroke="#526e52" class="loopLine"></line><line x1="65" y1="175" x2="65" y2="235" stroke-width="2" stroke="#526e52" class="loopLine"></line><rect x="65" y="175" fill="#526e52" stroke="none" width="50" height="20" rx="0" ry="0" class="labelBox"></rect><text x="72.5" y="190" fill="white" class="labelText"><tspan x="72.5">opt</tspan></text><text x="175" y="190" fill="black" class="loopText" style="text-anchor: middle;"><tspan x="175">[ 已有用户信息 ]</tspan></text></g><g><text x="375" y="263" class="messageText" style="text-anchor: middle;">发起网页授权</text><line x1="275" y1="270" x2="475" y2="270" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><text x="375" y="298" class="messageText" style="text-anchor: middle;">授权跳转链接(jumpUrl)</text><line x1="475" y1="305" x2="275" y2="305" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><text x="175" y="333" class="messageText" style="text-anchor: middle;">引导页面跳转</text><line x1="275" y1="340" x2="75" y2="340" class="messageLine1" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="stroke-dasharray: 3, 3; fill: none;"></line></g><g><text x="375" y="368" class="messageText" style="text-anchor: middle;">跳转授权页面</text><line x1="75" y1="375" x2="675" y2="375" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><rect x="600" y="385" fill="#EDF2AE" stroke="#666" width="150" height="36" rx="0" ry="0" class="note"></rect><text x="616" y="413" fill="black" class="noteText"><tspan x="616">用户授权</tspan></text></g><g><text x="375" y="449" class="messageText" style="text-anchor: middle;">跳转回调页面</text><line x1="675" y1="456" x2="75" y2="456" class="messageLine1" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="stroke-dasharray: 3, 3; fill: none;"></line></g><g><text x="175" y="484" class="messageText" style="text-anchor: middle;">跳转 redirect_uri(code)</text><line x1="75" y1="491" x2="275" y2="491" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><text x="375" y="519" class="messageText" style="text-anchor: middle;">请求用户信息(code)</text><line x1="275" y1="526" x2="475" y2="526" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><text x="575" y="554" class="messageText" style="text-anchor: middle;">请求token (code|appID|secret)</text><line x1="475" y1="561" x2="675" y2="561" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><text x="575" y="589" class="messageText" style="text-anchor: middle;">access_token|refresh_token</text><line x1="675" y1="596" x2="475" y2="596" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><rect x="400" y="631" fill="#EDF2AE" stroke="#666" width="150" height="36" rx="0" ry="0" class="note"></rect><text x="416" y="659" fill="black" class="noteText"><tspan x="416">存储 token</tspan></text></g><g><line x1="390" y1="606" x2="560" y2="606" stroke-width="2" stroke="#526e52" class="loopLine"></line><line x1="560" y1="606" x2="560" y2="677" stroke-width="2" stroke="#526e52" class="loopLine"></line><line x1="390" y1="677" x2="560" y2="677" stroke-width="2" stroke="#526e52" class="loopLine"></line><line x1="390" y1="606" x2="390" y2="677" stroke-width="2" stroke="#526e52" class="loopLine"></line><rect x="390" y="606" fill="#526e52" stroke="none" width="50" height="20" rx="0" ry="0" class="labelBox"></rect><text x="397.5" y="621" fill="white" class="labelText"><tspan x="397.5">opt</tspan></text><text x="475" y="621" fill="black" class="loopText" style="text-anchor: middle;"><tspan x="475">[ optional ]</tspan></text></g><g><text x="575" y="705" class="messageText" style="text-anchor: middle;">请求用户信息(access_token)</text><line x1="475" y1="712" x2="675" y2="712" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><text x="575" y="740" class="messageText" style="text-anchor: middle;">用户信息</text><line x1="675" y1="747" x2="475" y2="747" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><rect x="400" y="782" fill="#EDF2AE" stroke="#666" width="150" height="36" rx="0" ry="0" class="note"></rect><text x="416" y="810" fill="black" class="noteText"><tspan x="416">存储用户信息</tspan></text></g><g><line x1="390" y1="757" x2="560" y2="757" stroke-width="2" stroke="#526e52" class="loopLine"></line><line x1="560" y1="757" x2="560" y2="828" stroke-width="2" stroke="#526e52" class="loopLine"></line><line x1="390" y1="828" x2="560" y2="828" stroke-width="2" stroke="#526e52" class="loopLine"></line><line x1="390" y1="757" x2="390" y2="828" stroke-width="2" stroke="#526e52" class="loopLine"></line><rect x="390" y="757" fill="#526e52" stroke="none" width="50" height="20" rx="0" ry="0" class="labelBox"></rect><text x="397.5" y="772" fill="white" class="labelText"><tspan x="397.5">opt</tspan></text><text x="475" y="772" fill="black" class="loopText" style="text-anchor: middle;"><tspan x="475">[ optional ]</tspan></text></g><g><text x="375" y="856" class="messageText" style="text-anchor: middle;">用户信息</text><line x1="475" y1="863" x2="275" y2="863" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><text x="175" y="891" class="messageText" style="text-anchor: middle;">web服务</text><line x1="275" y1="898" x2="75" y2="898" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><rect x="0" y="918" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="75" y="955.5" class="actor" style="text-anchor: middle;">user</text></g><g><rect x="200" y="918" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="275" y="955.5" class="actor" style="text-anchor: middle;">web</text></g><g><rect x="400" y="918" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="475" y="955.5" class="actor" style="text-anchor: middle;">weshin</text></g><g><rect x="600" y="918" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="675" y="955.5" class="actor" style="text-anchor: middle;">wechat</text></g></svg>